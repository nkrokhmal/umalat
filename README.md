# Docker 

Команда для сборки докер контейнера
```sh
  docker-compose up -d
```

Run all tests
```sh
  docker-compose -f docker-compose-test.yaml up --build
```

# Scheduler 

Цеха: 
- Моцарелла
  - Бонус: упаковка терки (работает тогда, когда нет линии воды и есть план варок во вкладке "терка" в файле плана варок)
- Рикотта
- Маскарпоне 
- Масло
- Милкпроджект: по факту адыгейский и брынза (от милкпроджекта осталось только название)

В каждом цеху есть набор одинаковых функций построения расписания

Псевдокод
- to_boiling_plan(str: boiling_plan_filename) -> pd.DataFrame
- make_schedule(str: boiling_plan_filename) -> Block (расписание в виде блоков)
- wrap_frontend(str: boiling_plan_filename) -> Block: оборачивает расписание в новый блок фронтенда (который уже будет рисоваться)
- draw_frontend(str: boiling_plan_filename, STYLE: dict) -> None: рисует расписание в excel файле
Вот эти функции кумулятивные (каждая следующая по факту сначала вызывает предыдущую, а потом делает что-то свое) 


Есть библиотека utils_ak.block, с помощью которой строяться блоки расписания с разными правилами внутри. 

Основной юз кейс использования либы: block_maker.py (там есть примеры-тесты)

Есть несколько способов получать детей блоков: 
- parent['child_class'] - даст ребенка с классов child_class, если он один. И список всех детей, если их несколько 
- parent['child_class', True] - всегда вернет список детей, даже если он из одного элемента
- parent.iter(condition) -> итератор, который бежит по всем узлам, с которым работает condition

Конвертация времени: 
- cast_time(five_minutes_count: int) -> str (10 -> '00:50')
- cast_t(time: str) -> int (five_minutes_count) ('00:50' -> 10)

Функции вставки: 
- add_push: просто вставка без валидатора
- simple_push: просто вставка, можно указать валидатор
- stack_push: вставляем блоки "по очереди" 
- AxisPusher(): вставляем блоки "по оси" (по времени) с валидатором. Точка отсчета (можно задать в параметрах). Он пробует вставить блок. Получилось - отлично. Не получилось - значит кто-то мешает. Более того, валидаторы в тексте ошибки возвращают насколько мешается. Он прибавляет это число и пробует вставлять вставлять дальше с новой координатой. Зациклиться не может, зарейзит ошибку.


# Модели 