{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}

{% block title %} Расписание {% endblock %}
{% block page_content %}

<link rel="stylesheet" type="text/css" href="static/css/templates/parse_request.css" />
<link href="static/css/datatables2.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">


<script type='text/javascript' src="static/js/jquery.min.js"></script>
<script type='text/javascript' src="static/js/bootstrap.min.js"></script>
<script type='text/javascript' src="static/js/mdb.min.js"></script>
<script type='text/javascript' src="static/js/datatables2.min.js" defer></script>
<script type='text/javascript' src="static/js/templates/parse_request.js"></script>


<main>
    <div class="header-img">
         <img src= "{{ url_for('static', filename='schedule.jpg') }}" style="display: block; object-fit: cover; border-radius: 0px; width: 100%; height: 30vh; opacity: 1; object-position: center 60%;">
    </div>
</main>

<div class="page-header">
    <h1> Загрузите файл плана по варкам и выберите дату </h1>
</div>
<div class="col-md-6" style="margin-bottom: 20px;">
    {{ wtf.quick_form(form) }}
</div>

{% if filename %}
    <div class="col-md-6" style="margin-bottom: 20px;">
        <script>
            function download(url, filename) {
            fetch(url).then(function(t) {
                return t.blob().then((b)=>{
                    var a = document.createElement("a");
                    a.href = URL.createObjectURL(b);
                    a.setAttribute("download", filename);
                    a.click();
                }
                );
            });
            }
            var url = "download_schedule_plan/" + "{{filename}}";
            download(url,"{{file_name}}");
        </script>
    </div>
{% endif %}
{% endblock %}