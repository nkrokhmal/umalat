{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}

{% block title %} Форм фактор плавления - Параметры {% endblock %}

{% block page_content %}
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script type="text/javascript">
    $(function () {
        $(".delete-current-ff").click(function () {
            var id = $(this).data('id');
            $(".btn.btn-danger.btn-ok").attr("data-id", id);
        })
    });
</script>

<script type="text/javascript">
    $(function () {
        $(".btn.btn-danger.btn-ok").click(function(){
            var id = $(this).attr("data-id");
            $.ajax(
            {
                url: '/delete_boiling_form_factor/' + id,
                type: 'DELETE',
                success: function(res)
                {
                    console.log(res);
                },
                error: function(error) {
                      console.log(error);
                }
            });
        });
        $(".delete-current-ff").click(function () {
            var id = $(this).data('id');
            $(".btn.btn-danger.btn-ok").click(function(){
                $.ajax(
                {
                    url: '/delete_boiling_form_factor/' + id,
                    type: 'DELETE',
                    success: function(res)
                    {
                        console.log(res)
                    },
                    error: function(error) {
                          console.log(error);
                    }
                });
            });
        })
    });
</script>

<p>
    <a href="{{ url_for('main.add_form_factor')}}"><big> Добавить новый форм фактор плавления </big> </a>
</p>

<table class="table table-hover bff" id="bff">
    <thead>
        <tr>
            <th>Вес, г</th>
            <th>Название форм фактора</th>
            <th>Группа</th>
            <th>Время первого охлаждения, мин</th>
            <th>Время второго охлаждения, мин</th>
            <th>Время посолки, мин</th>
            <th> Действия </th>
        </tr>
    </thead>
    {% for form_factor in form_factors %}
    <tr>
        <td align="center"> {{form_factor.relative_weight}} </td>
        <td > {{form_factor.name}} </td>
        <td> {{form_factor.group.name}} </td>
        <td align="center">
            {% if form_factor.default_cooling_technology.first_cooling_time %}
                {{form_factor.default_cooling_technology.first_cooling_time}}
            {% else %}
                &nbsp;
            {% endif %}
        </td>
        <td align="center">
            {% if form_factor.default_cooling_technology.second_cooling_time %}
                {{form_factor.default_cooling_technology.second_cooling_time}}
            {% else %}
                &nbsp;
            {% endif %}
        </td>
        <td align="center">
            {% if form_factor.default_cooling_technology.salting_time %}
                {{form_factor.default_cooling_technology.salting_time}}
            {% else %}
                &nbsp;
            {% endif %}
        </td>
        <td>
            <a href="{{ url_for('main.edit_form_factor', ff_id = form_factor.id)}}" class="edit-ff">
                <i class="material-icons" style="color:green" title="Edit"> &#xe3c9; </i>
            </a>
            <a href="#delete_ff" class="delete-current-ff" data-id={{form_factor.id}} data-toggle="modal">
                <i class="material-icons" data-toggle="tooltip" style="color:red" title="Delete"> &#xE872; </i>
            </a>
            <div id="delete_ff" class="modal fade" >
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form>
                            <div class="modal-header">
                                <h4 class="modal-title">Удалить форм фактор плавления</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Вы уверены, что хотите удалить этот форм фактор плавления?</p>
                                <p class="text-warning"><small>Это действие не может быть отменено</small></p>
                            </div>
                            <div class="modal-footer">
                                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                                <input type="submit" class="btn btn-danger btn-ok" value= Delete>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}